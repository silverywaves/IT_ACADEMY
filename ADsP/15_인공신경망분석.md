## 인공신경망 분석
### 1. 인공신경망 분석(ANN)
- 인공신경망을 이용하면 분류 및 회구, 예측을 할 수 있음
- 입력층, 은닉층, 출력층 총 3개의 층으로 구성
- 각 층에 뉴런(노드)이 여러개 포함되어있음
- 학습 : 입력에 대한 올바른 출력이 나오도록 가중치(weight) 조절
- 가중치 초기화는 -1.0 ~ 1.0 사이의 임의값으로 설정, 지나치게 큰 값으로 초기화하면 활성화 함수를 편향시킴
  - 활성화 함수가 과적합되는 상태 = 포화상태

![인공신경망](https://github.com/silverywaves/IT_ACADEMY/assets/155939946/a7f4bc92-d454-4adc-b844-a10a5b8bc6de)

 ---

### 2. 경사하강법(Gradient descent)
- 함수 기울기를 낮은 쪽으로 계속 이동시켜 극 값에 이를때까지 반복
- 제시된 함수의 기울기 최솟값을 찾아내는 머신러닝 알고리즘
- 비용함수(cost function)를 최소화하기위해 parameter 반복 조정

- 경사하강법 과정
  - 임의의 parameter 값으로 시작
  - Cost Function 계산 : 모델을 구성하는 가중치 w의 함수 시작점에서 곡선 기울기 계산
  - parameter 값 갱신 : w = w - learningrate x 기울기 미분값
  - n 번의 iteration, 최솟값을 향해 수렴. learning rate 가 적절해야함
    
![경사하강법](https://github.com/silverywaves/IT_ACADEMY/assets/155939946/9e046f40-aa41-4ca0-9ed9-560662c4b3a6)


 ---

### 3. 인공신경망 모형의 장단점
#### 인공신경망 모형의 장점
  - 변수가 많거나 입, 출력 변수간에 복잡한 비선형 관계에 유용
  - 이상치 잡음에 대해서도 민감하게 반응X
  - 입력변수와 결과변수가 연속형이나 이산형인 경우 모두 처리 가능


#### 인공신경망 모형의 단점
  - 결과에 대한 해석이 쉽지 않음
  - 최적모형 도출이 상대적으로 어려움
  - 모형이 복잡하면 훈련과정에 시간이 많이 소요
  - 데이터를 정규화하지 않으면 지역해(local minimum)에 빠질 위험


---

### 4. 신경망 활성화함수
- 결과값을 내보낼 때 사용하는 함수
  - 가중치 값을 학습할 때 에러가 적게 나도록 도와줌
- 풀고자 하는 문제 종류에 따라 활성화 함수 선택이 달라짐

#### 활성화 함수의 종류
  - 계단함수 : 0 or 1
  - 부호함수 : -1 or 1
  - 선형함수 : y = x (문제 결과가 직선을 따르는 경향이 있으면 사용)
  - **sigmoid 함수**
    - 연속형 0~1, Logistic 함수라 불리기도 함
    - 선형적인 멀티 퍼셉트론에서 비선형 값을 얻기 위해 사용
  - **softmax 함수**
    - 모든 logits 의 합이 1이 되도록 ouput 정규화
    - sigmoid 함수의 일반화된 형태로 결과가 다 범주인 경우, 각 범주에 속할 사후확률(posterior probability) 제공하는 활성화 함수
    - 주로 3개 이상 분류시 사용


---

### 5. 신경망은닉층, 은닉노드
- 다층신경망은 단측신경망에 비해 훈련이 어려움
- 은닉층 수와 은닉노드 수의 결정은 분석가가 분석경험에 의해 설정


#### 은닉층 노드가 너무 적으면
  - 네트워크가 복잡한 의사결정 경계 만들 수 없음
  - Underfitting 문제 발생


#### 은닝층 노드가 너무 많으면
  - 복잡성을 잡아낼 수 있지만, 일반화가 어려움
  - 레이어가 많아지면 기울기 소실 문제 발생
  - 과적합(Overfitting) 문제 발생


#### 역전파 알고리즘(Backpropagation Algorithm)
  - 출력층에서 제시한 값에 대해 실제 원하는 값으로 학습하는 방법으로 사용
  - 동일 입력층에 대해 원하는 값이 출력되도록 개개의 weight를 조정하는 방법으로 사용


#### 기울기 소실문제(Vanishing Gradient Problem)
  - 다층신경망에서 은닉층이 많아 인공신경망 기울기값을 베이스로하는 역전파 알고리즘으로 학습시키려고 할 때 발생하는 문제
  - 역전파 알고리즘은 출력층(out layer)에서 입력층(input layer)으로 오차 Gradient를 흘려보내면서, 
    각 뉴런의 입력값에 대한 손실함수 Gradient 계산
    - 계산된 Gradient를 사용하여 각 가중치 매개변수를 업데이트
  - 다층신경망에서 역전파 알고리즘이 입력층으로 갈수록 Gradient가 점차 작아져 0에 수렴, weight가 업데이트 되지 않는 현상 발생
  - actraion function으로 sigmoid 함수를 사용할 때 발생
    - ReLU 등 사용하여 해결


---

### 6. 모형평가
#### 1. 홀드아웃(Hold Out)
  - 원천 데이터를 랜덤하게 두 분류로 분리하여 교차검증을 실시하는 방법
  - 훈련용 데이터
  - 검증용 데이터(train-test set 8:2 비율)


#### 2. 교차검증(Cross Validation)
  - 데이터가 충분하지 않을 경우, Hold out 으로 나누면 많은 양의 분산 발생
    - 해결책 : 교차검증, 클래스 불균형시 사용부적합
  - 주어진 데이터를 가지고 반복적으로 성과를 측정하여 그 결과로 평균
    - 분류분석 모형의 평가방법


#### 3. 붓스트랩(Bootstrap)
  - 평가를 반복(교차검증과 유사), 훈련 data를 반복하여 재선정
  - 붓스트랩은 관측치를 한 번 이상 훈련용 자료로 사용, 복원추출법 기반
  - 데이터 양이 크지 않을 경우 모형평가에 가장 적합
  - 데이터양이 크지 않을 경우 모형평가에 가장 적합
  - 훈련데이터를 63.2% 사용하는 0.632 붓스트랩이 있음


---

### 7. 오분류표를 활용한 평가지표
- 실제값 == 예측값 : True
- 실제값 != 예측값 : False
- True 예측값 : Positive
- False 예측값 : Negative

![오분류표](https://github.com/silverywaves/IT_ACADEMY/assets/155939946/c5866d66-4f8b-4309-ae5f-33e110cd66e7)

#### 정밀도, 정확도(Precision)
  - 예측값이 True 인 것에 대해 실제값이 True 인 지표
  - TP / (TP+FP)


#### 재현율, 민감도(Sensitivity)
  - 실제값이 True 인 것에 대해 예측값이 True 인 지표
  - TP / (TP+FN)


#### F1 Score
  - 데이터가 불균형할 때 사용
  - 오분류표 중 정밀도와 민감도의 조화평균을 나타내며 정밀도와 민감도에 같은 가중치를 부여하여 평균한 지표
  - { (정밀도 * Recall) / (정밀도 + Recall) } * 2


#### 재현율(Recall)
  - 민감도와 같음
  - TP / (TP+FN)


#### 정분류율(Accuracy)
  - (TN+TP) / TOTAL


#### 오분류율(Error Rate)
  - (FN+FP) / TOTAL


#### 특이도(Specificity)
  - TN / (TN+FP)  <- 실제 N 인 것 中 N 으로 예측한 것


#### FP Rate
  - 1 - Specificity = 1 - { FP / (TN+FP) }  <- N 인데 Y 로 예측(1종오류)


#### Kappa
  - 두 평가자의 평가가 얼마나 일치하는지 평가하는 값. 0~1 사이값
  - (Accuracy - P(e)) / (1 - P(e))  <- P(e) : 우연히 일치할 확률


#### F2
  - 재현율(Recall)의 2배만큼 가중치 부여


---

### 8. ROC Curve
  - ROC 그래프 밑부분 면적(AUC-Area Under Curve)이 넓을수록 좋은 모형
  - Perfect classifier : 긍정, 부정 모두 다 맞추는 위치. 성능이 가장 우수 (x = 0, y = 1)


![ROC Curve](https://github.com/silverywaves/IT_ACADEMY/assets/155939946/3ea1f752-7219-47f4-8dee-8962237865a8)


